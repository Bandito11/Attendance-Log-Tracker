{"version":3,"names":["url","async","addFeedback","data","feedback","componentKey","response","fetch","headers","body","JSON","stringify","method","mode","status","message","text","error","parse","feedbackComponentCss","FeedbackComponent","constructor","hostRef","this","cssClass","shadow","concat","componentDidLoad","input","el","shadowRoot","querySelector","focus","render","h","Host","type","onInput","event","handleChange","class","onClick","onCancel","target","value","preventDefault","feedbackCreated","emit","console","cancelClicked","feedbackContainerCss","FeedbackContainer","cancelClickedHandler","hidden","detail","feedbackCreatedHandler","getFeedbackCreated","id","getFeedbackComponent","showFeedbackComponent"],"sources":["./src/services/feedback-service.ts","./src/components/feedback-component/feedback-component.css?tag=feedback-component&encapsulation=shadow","./src/components/feedback-component/feedback-component.tsx","./src/containers/feedback-container/feedback-container.css?tag=feedback-container&encapsulation=shadow","./src/containers/feedback-container/feedback-container.tsx"],"sourcesContent":["import { IFeedback } from '../../../common/models';\n\nconst url = 'https://feedback-d71f5.uc.r.appspot.com/add';\nexport async function addFeedback(\n  data: Partial<IFeedback> & { componentKey: string; feedback: string }\n) {\n  if (!data.feedback) {\n    throw `Feedback property is empty`;\n  }\n  if (!data.componentKey) {\n    throw `component Id property is empty`;\n  }\n  const feedback = {\n    feedback: data.feedback,\n  } as Partial<IFeedback>;\n  const response = await fetch(url, {\n    headers: [['component-key', data.componentKey]],\n    body: JSON.stringify(feedback),\n    method: 'POST',\n    mode: 'cors',\n  });\n  if (response.status === 200) {\n    const message = await response.text();\n    if (message === 'true') {\n      return true;\n    } else {\n      try {\n        const error = JSON.parse(message);\n        return error.error;\n      } catch (error) {\n        return error;\n      }\n    }\n  }\n}\n",":host {\n  display: block;\n}\n\ninput {\n  padding: 0.2em;\n}\n\nbutton {\n  margin-top: 0.3em;\n  border-radius: 4px;\n  border: none;\n  padding: 6px;\n  text-align: center;\n  text-decoration: none;\n}\n\n.confirm {\n  background-color: #0074d9;\n  color: #f6f6f6;\n  margin-left: 2em;\n}\n\n.cancel {\n  background-color: #e1e1e1;\n}\n\n.shadow:hover {\n  box-shadow: 0 8px 12px 0 rgba(0, 0, 0, 0.24), 0 7px 8px 0 rgba(0, 0, 0, 0.19);\n}\n","import { Component, Host, Element, h, Prop } from '@stencil/core';\nimport { Event, EventEmitter } from '@stencil/core';\nimport { addFeedback } from '../../services/feedback-service';\n\n@Component({\n  tag: 'feedback-component',\n  styleUrl: 'feedback-component.css',\n  shadow: true,\n})\nexport class FeedbackComponent {\n  @Prop() componentKey: string;\n  @Prop() shadow: boolean;\n  cssClass: string;\n\n  @Event() cancelClicked: EventEmitter<boolean>;\n  @Event() feedbackCreated: EventEmitter<boolean>;\n  @Element() el: HTMLElement;\n  feedback: string;\n\n  constructor() {\n    this.cssClass = '';\n    if (this.shadow === true) {\n      this.cssClass = this.cssClass.concat('shadow ');\n    }\n  }\n\n  componentDidLoad() {\n    const input = this.el.shadowRoot.querySelector('input');\n    input.focus();\n  }\n\n  render() {\n    return (\n      <Host>\n        <form>\n          <input type='text' onInput={(event) => this.handleChange(event)} />\n          <div>\n            <button\n              class={this.cssClass + 'cancel '}\n              onClick={(event) => this.onCancel(event)}\n            >\n              Cancel\n            </button>\n            <button\n              class={this.cssClass + 'confirm '}\n              type='submit'\n              onClick={(event) => this.addFeedback(event)}\n            >\n              Feedback\n            </button>\n          </div>\n        </form>\n      </Host>\n    );\n  }\n  handleChange(event): void {\n    this.feedback = event.target.value;\n  }\n  async addFeedback(event): Promise<void> {\n    event.preventDefault();\n    if (this.feedback) {\n      try {\n        const message = await addFeedback({\n          componentKey: this.componentKey,\n          feedback: this.feedback,\n        });\n        if (message === true) {\n          this.feedbackCreated.emit(message);\n        } else {\n          //TODO: Check if this error can be catch outside via events\n          console.error(message);\n        }\n      } catch (error) {\n        //TODO: Check if this error can be catch outside via events\n        console.error(error);\n      }\n    }\n  }\n\n  onCancel(event) {\n    event.preventDefault();\n    this.cancelClicked.emit(true);\n  }\n}\n",":host {\n  display: block;\n}\n\nbutton {\n  border-radius: 4px;\n  border: none;\n  background-color: #f6f6f6;\n  padding: 6px;\n  text-align: center;\n  text-decoration: none;\n}\n\n.shadow:hover {\n  box-shadow: 0 8px 12px 0 rgba(0, 0, 0, 0.24), 0 7px 8px 0 rgba(0, 0, 0, 0.19);\n}\n\n.thank-you {\n  border: 2px solid #f6f6f6;\n  width: 13em;\n  padding: 0.4em;\n  color: #2ecc40;\n  box-shadow: 0 5px 8px 0 rgba(17, 17, 17, 0.24),\n    0 4px 5px 0 rgba(31, 31, 31, 0.19);\n    animation: fadeInAnimation ease 1s;\n    animation-iteration-count: 1;\n    animation-fill-mode: forwards;\n}\n@keyframes fadeInAnimation {\n  0% {\n      opacity: 0;\n  }\n  100% {\n      opacity: 1;\n  }\n}\n.heart-icon {\n  color: #ff4136;\n  font-size: 1.1em;\n}\n","import { Component, Host, h, State, Listen, Prop } from '@stencil/core';\n\n//TODO Change tag property to final name of the component\n@Component({\n  tag: 'feedback-container',\n  styleUrl: 'feedback-container.css',\n  shadow: true,\n})\nexport class FeedbackContainer {\n  @Prop() componentKey: string;\n  @Prop() shadow: boolean;\n\n  @State() hidden: boolean;\n  @State() feedbackCreated: boolean;\n\n  cssClass: string;\n\n  @Listen('cancelClicked')\n  cancelClickedHandler(event: CustomEvent<boolean>) {\n    this.hidden = event.detail;\n  }\n\n  @Listen('feedbackCreated')\n  feedbackCreatedHandler(event: CustomEvent<boolean>) {\n    this.feedbackCreated = event.detail;\n  }\n  constructor() {\n    this.hidden = true;\n    this.feedbackCreated = false;\n    this.cssClass = '';\n    if (this.shadow === true) {\n      this.cssClass = this.cssClass.concat('shadow ');\n    }\n  }\n\n  getFeedbackCreated() {\n    if (this.feedbackCreated) {\n      return (\n        <div class='ripple-back' id='ripple-loader'>\n          <p class='thank-you ripple-loader'>\n            <span class='heart-icon'>&#9829;</span> Thanks for the feedback!\n          </p>\n        </div>\n      );\n    } else {\n      return this.getFeedbackComponent();\n    }\n  }\n\n  getFeedbackComponent() {\n    if (this.hidden) {\n      return (\n        <button\n          class={this.cssClass}\n          onClick={() => this.showFeedbackComponent()}\n        >\n          Feedback?\n        </button>\n      );\n    } else {\n      return (\n        <feedback-component\n          componentKey={this.componentKey}\n          shadow={this.shadow}\n        ></feedback-component>\n      );\n    }\n  }\n\n  render() {\n    return <Host>{this.getFeedbackCreated()}</Host>;\n  }\n  showFeedbackComponent(): void {\n    if (this.hidden) {\n      this.hidden = false;\n    } else {\n      this.hidden = true;\n    }\n  }\n}\n"],"mappings":"gEAEA,MAAMA,EAAM,8CACLC,eAAeC,EACpBC,GAEA,IAAKA,EAAKC,SAAU,CAClB,KAAM,4B,CAER,IAAKD,EAAKE,aAAc,CACtB,KAAM,gC,CAER,MAAMD,EAAW,CACfA,SAAUD,EAAKC,UAEjB,MAAME,QAAiBC,MAAMP,EAAK,CAChCQ,QAAS,CAAC,CAAC,gBAAiBL,EAAKE,eACjCI,KAAMC,KAAKC,UAAUP,GACrBQ,OAAQ,OACRC,KAAM,SAER,GAAIP,EAASQ,SAAW,IAAK,CAC3B,MAAMC,QAAgBT,EAASU,OAC/B,GAAID,IAAY,OAAQ,CACtB,OAAO,I,KACF,CACL,IACE,MAAME,EAAQP,KAAKQ,MAAMH,GACzB,OAAOE,EAAMA,K,CACb,MAAOA,GACP,OAAOA,C,GAIf,CClCA,MAAME,EAAuB,gV,MCShBC,EAAiB,MAU5BC,YAAAC,G,0JACEC,KAAKC,SAAW,GAChB,GAAID,KAAKE,SAAW,KAAM,CACxBF,KAAKC,SAAWD,KAAKC,SAASE,OAAO,U,EAIzCC,mBACE,MAAMC,EAAQL,KAAKM,GAAGC,WAAWC,cAAc,SAC/CH,EAAMI,O,CAGRC,SACE,OACEC,EAACC,EAAI,KACHD,EAAA,YACEA,EAAA,SAAOE,KAAK,OAAOC,QAAUC,GAAUf,KAAKgB,aAAaD,KACzDJ,EAAA,WACEA,EAAA,UACEM,MAAOjB,KAAKC,SAAW,UACvBiB,QAAUH,GAAUf,KAAKmB,SAASJ,IAAM,UAI1CJ,EAAA,UACEM,MAAOjB,KAAKC,SAAW,WACvBY,KAAK,SACLK,QAAUH,GAAUf,KAAKrB,YAAYoC,IAAM,c,CASvDC,aAAaD,GACXf,KAAKnB,SAAWkC,EAAMK,OAAOC,K,CAE/B3C,kBAAkBqC,GAChBA,EAAMO,iBACN,GAAItB,KAAKnB,SAAU,CACjB,IACE,MAAMW,QAAgBb,EAAY,CAChCG,aAAckB,KAAKlB,aACnBD,SAAUmB,KAAKnB,WAEjB,GAAIW,IAAY,KAAM,CACpBQ,KAAKuB,gBAAgBC,KAAKhC,E,KACrB,CAELiC,QAAQ/B,MAAMF,E,EAEhB,MAAOE,GAEP+B,QAAQ/B,MAAMA,E,GAKpByB,SAASJ,GACPA,EAAMO,iBACNtB,KAAK0B,cAAcF,KAAK,K,qCCjF5B,MAAMG,EAAuB,kkB,MCQhBC,EAAiB,MAU5BC,qBAAqBd,GACnBf,KAAK8B,OAASf,EAAMgB,M,CAItBC,uBAAuBjB,GACrBf,KAAKuB,gBAAkBR,EAAMgB,M,CAE/BjC,YAAAC,G,iHACEC,KAAK8B,OAAS,KACd9B,KAAKuB,gBAAkB,MACvBvB,KAAKC,SAAW,GAChB,GAAID,KAAKE,SAAW,KAAM,CACxBF,KAAKC,SAAWD,KAAKC,SAASE,OAAO,U,EAIzC8B,qBACE,GAAIjC,KAAKuB,gBAAiB,CACxB,OACEZ,EAAA,OAAKM,MAAM,cAAciB,GAAG,iBAC1BvB,EAAA,KAAGM,MAAM,2BACPN,EAAA,QAAMM,MAAM,cAAY,KAAe,6B,KAIxC,CACL,OAAOjB,KAAKmC,sB,EAIhBA,uBACE,GAAInC,KAAK8B,OAAQ,CACf,OACEnB,EAAA,UACEM,MAAOjB,KAAKC,SACZiB,QAAS,IAAMlB,KAAKoC,yBAAuB,Y,KAK1C,CACL,OACEzB,EAAA,sBACE7B,aAAckB,KAAKlB,aACnBoB,OAAQF,KAAKE,Q,EAMrBQ,SACE,OAAOC,EAACC,EAAI,KAAEZ,KAAKiC,qB,CAErBG,wBACE,GAAIpC,KAAK8B,OAAQ,CACf9B,KAAK8B,OAAS,K,KACT,CACL9B,KAAK8B,OAAS,I"}