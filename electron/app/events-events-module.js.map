{"version":3,"sources":["webpack:///./src/app/events/events.module.ts","webpack:///./src/app/events/events.page.html","webpack:///./src/app/events/events.page.scss","webpack:///./src/app/events/events.page.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAmE;AAC1B;AACM;AACF;AACU;AAEV;AAEF;AAE3C,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,uDAAU;KACtB;CACF,CAAC;AAYF;IAAA;IAA+B,CAAC;IAAnB,gBAAgB;QAV5B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,8EAAgB;gBAChB,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,uDAAU,CAAC;SAC3B,CAAC;OACW,gBAAgB,CAAG;IAAD,uBAAC;CAAA;AAAH;;;;;;;;;;;;AC3B7B,oFAAoF,4BAA4B,iMAAiM,kCAAkC,4HAA4H,mBAAmB,mNAAmN,QAAQ,KAAK,QAAQ,8JAA8J,YAAY,+DAA+D,YAAY,mEAAmE,mDAAmD,oBAAoB,UAAU,iBAAiB,mDAAmD,kBAAkB,UAAU,eAAe,iDAAiD,uBAAuB,UAAU,uBAAuB,yBAAyB,sBAAsB,UAAU,oBAAoB,yBAAyB,sBAAsB,UAAU,oBAAoB,iFAAiF,sBAAsB,UAAU,oBAAoB,qF;;;;;;;;;;;ACA1kD,+DAA+D,uI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAO;AAC5B;AACsB;AACoB;AACtC;AACL;AAOzC;IAmDE,oBACU,OAAsB,EACtB,EAAwB,EACxB,KAAsB,EACtB,OAAgB;QAHhB,YAAO,GAAP,OAAO,CAAe;QACtB,OAAE,GAAF,EAAE,CAAsB;QACxB,UAAK,GAAL,KAAK,CAAiB;QACtB,YAAO,GAAP,OAAO,CAAS;QArD1B,kBAAa,GAAa,CAAC,YAAY,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;QAC5E,WAAM,GAAU,EAAE,CAAC;QACnB,qBAAgB,GAAU,EAAE,CAAC;QAC7B,YAAO,GAAG,wBAAwB,CAAC;QACnC,iBAAY,GAAG;YACb,OAAO,EAAE;gBACP,KAAK,EAAE,EAAE;gBACT,OAAO,EAAE;oBACP,GAAG,EAAE,EAAE;iBACR;aACF;YACD,IAAI,EAAE,EAAE;YACR,KAAK,EAAE,EAAE;YACT,GAAG,EAAE,EAAE;YACP,QAAQ,EAAE,EAAE;YACZ,OAAO,EAAE,EAAE;YACX,OAAO,EAAE,EAAE;SACZ,CAAC;QACF,aAAQ,GAAG;YACT,OAAO,EAAE;gBACP,OAAO,EAAE;oBACP,KAAK,EAAE,QAAQ;oBACf,OAAO,EAAE;wBACP,GAAG,EAAE,cAAc;qBACpB;iBACF;gBACD,IAAI,EAAE,WAAW;gBACjB,KAAK,EAAE,cAAc;gBACrB,GAAG,EAAE,YAAY;gBACjB,QAAQ,EAAE,kBAAkB;gBAC5B,OAAO,EAAE,iBAAiB;gBAC1B,OAAO,EAAE,iBAAiB;aAC3B;YACD,OAAO,EAAE;gBACP,OAAO,EAAE;oBACP,KAAK,EAAE,SAAS;oBAChB,OAAO,EAAE;wBACP,GAAG,EAAE,cAAc;qBACpB;iBACF;gBACD,IAAI,EAAE,eAAe;gBACrB,KAAK,EAAE,YAAY;gBACnB,GAAG,EAAE,cAAc;gBACnB,QAAQ,EAAE,oBAAoB;gBAC9B,OAAO,EAAE,kBAAkB;gBAC3B,OAAO,EAAE,mBAAmB;aAC7B;SACF,CAAC;IAOE,CAAC;IAEL,2BAAM,GAAN;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;IACtB,CAAC;IAGD,oCAAe,GAAf;QAAA,iBASC;QARC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,eAAK;YACrC,IAAI,KAAK,EAAE;gBACT,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC1C;iBAAM;gBACL,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;aAC9C;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAED,6BAAQ,GAAR,UAAS,MAAM;QACb,QAAQ,MAAM,EAAE;YACd,KAAK,YAAY;gBACf,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBACxB,MAAM;YACR,KAAK,SAAS;gBACZ,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,MAAM;YACR,KAAK,MAAM;gBACT,IAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,MAAM;YACR,KAAK,MAAM;gBACT,IAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,MAAM;YACR;gBACE,IAAI,CAAC,MAAM,GAAO,IAAI,CAAC,gBAAgB,QAAC,CAAC;SAC5C;IACH,CAAC;IAED,qCAAgB,GAAhB;QACE,IAAI,CAAC,MAAM,GACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;YACvB,IAAI,CAAC,CAAC,UAAU,GAAG,CAAC,CAAC,UAAU,EAAE;gBAC/B,OAAO,CAAC,CAAC,CAAC;aACX;YACD,IAAI,CAAC,CAAC,UAAU,GAAG,CAAC,CAAC,UAAU,EAAE;gBAC/B,OAAO,CAAC,CAAC;aACV;YACD,OAAO,CAAC,CAAC;QACX,CAAC,CAAC,QACH,CAAC;IACJ,CAAC;IAED,kCAAa,GAAb;QACE,IAAI,CAAC,MAAM,GACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;YACvB,IAAI,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO,EAAE;gBACzB,OAAO,CAAC,CAAC,CAAC;aACX;YACD,IAAI,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO,EAAE;gBACzB,OAAO,CAAC,CAAC;aACV;YACD,OAAO,CAAC,CAAC;QACX,CAAC,CAAC,QACH,CAAC;IAEJ,CAAC;IAED,+BAAU,GAAV;QACE,IAAI,CAAC,MAAM,GACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;YACvB,IAAI,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE;gBAAE,OAAO,CAAC,CAAC,CAAC;aAAE;YAC/D,IAAI,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE;gBAAE,OAAO,CAAC,CAAC;aAAE;YAC9D,OAAO,CAAC,CAAC;QACX,CAAC,CAAC,QACH,CAAC;IACJ,CAAC;IAED,+BAAU,GAAV;QACE,IAAI,CAAC,MAAM,GACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;YACvB,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE;gBAC7B,OAAO,CAAC,CAAC,CAAC;aACX;YACD,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE;gBAC7B,OAAO,CAAC,CAAC;aACV;YACD,OAAO,CAAC,CAAC;QACX,CAAC,CAAC,QACH,CAAC;IACJ,CAAC;IAED,8BAAS,GAAT;QAAA,iBAqCC;QApCC,IAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC;QACrC,IAAI,QAAQ,CAAC,OAAO,EAAE;YACpB,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,cAAI;gBAClC,IAAI,UAAU,GAAG,CAAC,EAAE,OAAO,GAAG,CAAC,CAAC;gBAChC,IAAI,YAAY,GAAG,CAAC,CAAC;gBACrB,KAAqB,UAAY,EAAZ,SAAI,CAAC,OAAO,EAAZ,cAAY,EAAZ,IAAY,EAAE;oBAA9B,IAAM,MAAM;oBACf,IAAI,MAAM,CAAC,UAAU,EAAE;wBACrB,UAAU,IAAI,CAAC,CAAC;qBACjB;oBACD,IAAI,MAAM,CAAC,OAAO,EAAE;wBAClB,OAAO,IAAI,CAAC,CAAC;qBACd;oBACD,IAAM,aAAa,GAAG,KAAI,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACvD,IAAI,aAAa,EAAE;wBACjB,YAAY,EAAE,CAAC;qBAChB;yBAAM;wBACL,KAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC,CAAC;qBACjE;iBACF;gBACD,IAAI,KAAK,gBACJ,IAAI,IACP,SAAS,EAAE,iEAAU,CAAC,IAAI,CAAC,SAAS,CAAC,EACrC,YAAY,EAAE,YAAY,EAC1B,eAAe,EAAE,UAAU,EAC3B,YAAY,EAAE,OAAO,GACtB,CAAC;gBACF,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,KAAK,gBACA,KAAK,IACR,OAAO,EAAE,iEAAU,CAAC,IAAI,CAAC,OAAO,CAAC,GAClC,CAAC;iBACH;gBACD,OAAO,KAAK,CAAC;YACf,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,gBAAgB,GAAO,IAAI,CAAC,MAAM,QAAC,CAAC;SAC1C;IACH,CAAC;IAEK,oCAAe,GAArB;;;;;;4BACgB,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;4BACpC,SAAS,EAAE,+EAAe;yBAC3B,CAAC;;wBAFI,KAAK,GAAG,SAEZ;wBACF,KAAK,CAAC,OAAO,EAAE,CAAC;wBAChB,KAAK,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,WAAC,IAAI,YAAI,CAAC,SAAS,EAAE,EAAhB,CAAgB,CAAC,CAAC;;;;;KAClD;IAEK,qCAAgB,GAAtB,UAAuB,EAAE;;;gBACvB,IAAI,CAAC,OAAO,CAAC,eAAe,CAAI,IAAI,CAAC,OAAO,iBAAY,EAAI,CAAC,CAAC;;;;KAC/D;IAnMU,UAAU;QALtB,+DAAS,CAAC;YACT,QAAQ,EAAE,YAAY;YACtB,4FAAiC;;SAElC,CAAC;yCAqDmB,4DAAa;YAClB,iGAAoB;YACjB,8DAAe;YACb,sDAAO;OAvDf,UAAU,CAqMtB;IAAD,iBAAC;CAAA;AArMsB","file":"events-events-module.js","sourcesContent":["import { ComponentsModule } from '../components/components.module';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EventsPage } from './events.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EventsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ComponentsModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [EventsPage]\n})\nexport class EventsPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-title>{{htmlControls.toolbar.title}}</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"goToCreateEvent()\\\">{{htmlControls.toolbar.buttons.add}}</ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n  <ion-item>\\n    <ion-label>{{htmlControls.sort}}</ion-label>\\n    <ion-select interface=\\\"popover\\\" multiple=\\\"false\\\" placeholder=\\\"None\\\" #sort (ionChange)=\\\"sortData(sort.value)\\\">\\n      <ion-select-option *ngFor=\\\"let option of selectOptions\\\" value=\\\"{{option}}\\\">{{option}}</ion-select-option>\\n    </ion-select>\\n  </ion-item>\\n  <ion-card *ngFor=\\\"let event of events\\\" (click)=\\\"goToEventProfile(event.$loki)\\\">\\n    <img src={{event.logo}} />\\n    <ion-card-content>\\n      <ion-card-title>\\n        {{event.name}}\\n      </ion-card-title>\\n      <div *ngIf=\\\"!event.infiniteDates; else: infiniteDatesIsTrue\\\">\\n        <h3><span>{{htmlControls.start}}</span> {{event.startDate}}</h3>\\n        <h3 *ngIf=\\\"event.endDate\\\"><span>{{htmlControls.end}}</span> {{event.endDate}}</h3>\\n        <!-- <br> -->\\n        <p><span>{{htmlControls.attended}}</span> {{event.totalAttendance}}</p>\\n        <p><span>{{htmlControls.absence}}</span> {{event.totalAbsence}}</p>\\n        <p><span>{{htmlControls.members}}</span> {{event.totalMembers}}</p>\\n      </div>\\n      <ng-template #infiniteDatesIsTrue>\\n        <p><span>{{htmlControls.members}}</span> {{event.totalMembers}}</p>\\n      </ng-template>\\n    </ion-card-content>\\n  </ion-card>\\n\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2V2ZW50cy9ldmVudHMucGFnZS5zY3NzIn0= */\"","import { CreateEventPage } from './../create-event/create-event.page';\nimport { Component } from '@angular/core';\nimport { NavController, ModalController } from '@ionic/angular';\nimport { AmaranthusDBProvider } from 'src/app/services/amaranthus-db/amaranthus-db';\nimport { formatDate } from '../common/format';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-events',\n  templateUrl: './events.page.html',\n  styleUrls: ['./events.page.scss'],\n})\nexport class EventsPage {\n\n  selectOptions: string[] = ['Attendance', 'Absence', 'Name', 'Date', 'None'];\n  events: any[] = [];\n  unfilteredEvents: any[] = [];\n  homeURL = '/tabs/tabs/home/events';\n  htmlControls = {\n    toolbar: {\n      title: '',\n      buttons: {\n        add: ''\n      }\n    },\n    sort: '',\n    start: '',\n    end: '',\n    attended: '',\n    absence: '',\n    members: ''\n  };\n  LANGUAGE = {\n    english: {\n      toolbar: {\n        title: 'Events',\n        buttons: {\n          add: 'Create event'\n        }\n      },\n      sort: 'Sort By: ',\n      start: 'Start Date: ',\n      end: 'End Date: ',\n      attended: 'Total Attended: ',\n      absence: 'Total Absence: ',\n      members: 'Total Members: '\n    },\n    spanish: {\n      toolbar: {\n        title: 'Eventos',\n        buttons: {\n          add: 'Crear evento'\n        }\n      },\n      sort: 'Ordenar por: ',\n      start: 'Inicia en:',\n      end: 'Termina en: ',\n      attended: 'Asistencia Total: ',\n      absence: 'Ausencia Total: ',\n      members: 'Membresía Total: '\n    }\n  };\n\n  constructor(\n    private navCtrl: NavController,\n    private db: AmaranthusDBProvider,\n    private modal: ModalController,\n    private storage: Storage\n  ) { }\n\n  goBack() {\n    this.navCtrl.back();\n  }\n\n\n  ionViewDidEnter() {\n    this.storage.get('language').then(value => {\n      if (value) {\n        this.htmlControls = this.LANGUAGE[value];\n      } else {\n        this.htmlControls = this.LANGUAGE['english'];\n      }\n    });\n    this.getEvents();\n  }\n\n  sortData(option) {\n    switch (option) {\n      case 'Attendance':\n        this.sortByAttendance();\n        break;\n      case 'Absence':\n        this.sortByAbsence();\n        break;\n      case 'Name':\n        this.sortByName();\n        break;\n      case 'Date':\n        this.sortByDate();\n        break;\n      default:\n        this.events = [...this.unfilteredEvents];\n    }\n  }\n\n  sortByAttendance() {\n    this.events = [\n      ...this.events.sort((a, b) => {\n        if (a.attendance < b.attendance) {\n          return -1;\n        }\n        if (a.attendance > b.attendance) {\n          return 1;\n        }\n        return 0;\n      })\n    ];\n  }\n\n  sortByAbsence() {\n    this.events = [\n      ...this.events.sort((a, b) => {\n        if (a.absence < b.absence) {\n          return -1;\n        }\n        if (a.absence > b.absence) {\n          return 1;\n        }\n        return 0;\n      })\n    ];\n\n  }\n\n  sortByName() {\n    this.events = [\n      ...this.events.sort((a, b) => {\n        if (a.name.toLowerCase() < b.name.toLowerCase()) { return -1; }\n        if (a.name.toLowerCase() > b.name.toLowerCase()) { return 1; }\n        return 0;\n      })\n    ];\n  }\n\n  sortByDate() {\n    this.events = [\n      ...this.events.sort((a, b) => {\n        if (a.startDate < b.startDate) {\n          return -1;\n        }\n        if (a.startDate > b.startDate) {\n          return 1;\n        }\n        return 0;\n      })\n    ];\n  }\n\n  getEvents() {\n    const response = this.db.getEvents();\n    if (response.success) {\n      this.events = response.data.map(data => {\n        let attendance = 0, absence = 0;\n        let totalMembers = 0;\n        for (const member of data.members) {\n          if (member.attendance) {\n            attendance += 1;\n          }\n          if (member.absence) {\n            absence += 1;\n          }\n          const studentExists = this.db.studentExists(member.id);\n          if (studentExists) {\n            totalMembers++;\n          } else {\n            this.db.updateEventMembers({ name: data.name, member: member });\n          }\n        }\n        let event: any = {\n          ...data,\n          startDate: formatDate(data.startDate),\n          totalMembers: totalMembers,\n          totalAttendance: attendance,\n          totalAbsence: absence\n        };\n        if (data.endDate) {\n          event = {\n            ...event,\n            endDate: formatDate(data.endDate)\n          };\n        }\n        return event;\n      });\n      this.unfilteredEvents = [...this.events];\n    }\n  }\n\n  async goToCreateEvent() {\n    const modal = await this.modal.create({\n      component: CreateEventPage\n    });\n    modal.present();\n    modal.onDidDismiss().then(_ => this.getEvents());\n  }\n\n  async goToEventProfile(id) {\n    this.navCtrl.navigateForward(`${this.homeURL}/profile/${id}`);\n  }\n\n}\n"],"sourceRoot":""}